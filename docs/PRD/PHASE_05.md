# Phase 5: Team Management & Lifelines

- **Dependencies:** Phase 4 (Core gameplay functional)
- **Status:** Pending
- **USER_JOURNEY Reference:** [Journey 3, Phase B: Lifeline Usage](../USER_JOURNEY.md#step-5-lifeline-usage-before-answer-lock), [Journey 3, Phase C: Team Transition](../USER_JOURNEY.md#phase-c-transition-to-next-team-automatic)

| Requirement ID | Description                    | User Story                                                                              | Expected Behavior/Outcome                                                                                                                                                                                     |
| -------------- | ------------------------------ | --------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **P5-REQ-001** | Team Status Panel Component    | As a host, I need to see all teams so that I can monitor overall progress               | - Grid/list of team cards<br>- Real-time status updates<br>- Color-coded by status<br>- Scrollable if many teams                                                                                              |
| **P5-REQ-002** | Team Card Component            | As a host, I need individual team displays so that I can see team details at a glance   | - Team name, status badge<br>- Progress: X/QUESTIONS_PER_SET questions<br>- Current prize amount<br>- Lifelines available (icons)<br>- Color: Blue=active, Grey=waiting, Red=eliminated, Green=completed      |
| **P5-REQ-003** | Active Team Highlighting       | As a host, I need to identify the current team so that I know who is playing            | - Active team card: blue border, blue background<br>- Scroll active team into view<br>- Pulse animation (subtle)<br>- "PLAYING NOW" badge                                                                     |
| **P5-REQ-004** | Lifeline Controls Component    | As a host, I need lifeline buttons so that I can activate them when requested           | - "Phone-a-Friend" button<br>- "50/50" button<br>- Disabled if already used<br>- Visual indicator (greyed out)<br>- Only enabled for active team                                                              |
| **P5-REQ-005** | Phone-a-Friend Activation      | As a host, I need to activate Phone-a-Friend so that teams can call for help            | - Click button<br>- Update Firebase: phone-a-friend = false<br>- Button becomes disabled/greyed<br>- Team card updates icon<br>- Show "Timer paused" message<br>- Manual resume by host                       |
| **P5-REQ-006** | 50/50 Activation               | As a host, I need to activate 50/50 so that two incorrect options are removed           | - Click button<br>- Filter options (remove 2 incorrect)<br>- Update Firebase with filtered options<br>- Public display shows only 2 options<br>- Button becomes disabled/greyed<br>- Team card updates icon   |
| **P5-REQ-007** | 50/50 Logic Implementation     | As a system, I need to intelligently remove wrong answers so that 50/50 works correctly | - Keep correct answer<br>- Keep one random incorrect answer<br>- Remove other two incorrect answers<br>- Update current-question in Firebase<br>- Public sees updated options instantly                       |
| **P5-REQ-008** | Lifeline State Synchronization | As a system, I need to sync lifeline states so that all views are consistent            | - Update team in Firebase<br>- Update team card UI<br>- Update lifeline buttons<br>- Persist across page reloads<br>- Real-time to all connected clients                                                      |
| **P5-REQ-009** | Team Elimination Logic         | As a system, I need to eliminate teams so that game rules are enforced                  | - Set status = 'eliminated'<br>- Add eliminated-at timestamp<br>- Freeze current-prize at last correct<br>- Disable all controls for team<br>- Card turns red with badge                                      |
| **P5-REQ-010** | Team Completion Logic          | As a system, I need to mark teams as winners so that success is recorded                | - After Q20 answered correctly<br>- Set status = 'completed'<br>- Set final prize (max from prize-structure)<br>- Card turns green with "WINNER" badge<br>- Celebration animation                             |
| **P5-REQ-011** | Next Team Transition           | As a host, I need to move to next team so that gameplay continues                       | - "Next Team" button appears after completion/elimination<br>- Clear current question<br>- Reset game state<br>- Load next team from queue<br>- Set new team as active<br>- Load their question set           |
| **P5-REQ-012** | Next Team Auto-Load            | As a system, I need to auto-load next team so that transitions are smooth               | - Get next team ID from play queue<br>- Update current-team-id in Firebase<br>- Set team status = 'active'<br>- Load team's assigned question set<br>- Reset question number to 0<br>- Public display updates |
| **P5-REQ-013** | Team List Real-Time Updates    | As a host, I need live team updates so that I see current states                        | - Listen to Firebase teams node<br>- Update team cards on change<br>- Animate status changes<br>- Sort: active first, then waiting, then completed/eliminated                                                 |
| **P5-REQ-014** | No More Teams Handler          | As a system, I need to detect game end so that event concludes properly                 | - Check if queue is empty<br>- Update game-status = 'completed'<br>- Show "All Teams Complete" message<br>- Enable "View Results" button<br>- Disable question controls                                       |

**Phase 5 Acceptance Criteria:**

- ✅ Team cards show accurate real-time status
- ✅ Lifelines work correctly and update UI
- ✅ 50/50 removes correct wrong answers
- ✅ Team transitions happen smoothly
- ✅ Elimination and completion logic is correct
- ✅ Game detects end condition properly
